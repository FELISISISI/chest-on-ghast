# 快乐恶魂等级系统说明文档

## 概述
为Minecraft模组"Chest on Ghast"成功实现了一个完整的等级系统，包含经验值、饱食度管理和GUI界面。

## 主要功能

### 1. 等级系统（6个等级）

每个等级有不同的属性：

| 等级 | 最大血量 | 最大饱食度 | 升级所需经验 | 饱食度降低速率 |
|------|----------|------------|--------------|----------------|
| 1    | 20.0     | 20.0       | 100          | 0.05/秒        |
| 2    | 30.0     | 30.0       | 200          | 0.04/秒        |
| 3    | 45.0     | 45.0       | 350          | 0.03/秒        |
| 4    | 65.0     | 65.0       | 550          | 0.025/秒       |
| 5    | 90.0     | 90.0       | 800          | 0.02/秒        |
| 6    | 120.0    | 120.0      | -（满级）    | 0.015/秒       |

**设计理念**：
- 等级越高，血量和饱食度越高
- 饱食度降低速度随等级提升而减慢
- 升级所需经验值呈递增趋势，保持游戏平衡

### 2. 喂食系统

**操作方式**：对着快乐恶魂右键使用食物

**食物经验值**：
- 基础食物（苹果、胡萝卜、土豆）：+5 经验
- 中级食物（面包、熟鸡肉、熟羊肉）：+10 经验
- 高级食物（熟牛肉、熟猪肉、金胡萝卜）：+20 经验
- 顶级食物（金苹果、附魔金苹果）：+50 经验
- 其他可食用物品：+8 经验

**饱食度恢复**：
- 根据食物的营养值自动计算（营养值 × 2）
- 默认恢复10点饱食度

**升级机制**：
- 达到所需经验值自动升级
- 升级时饱食度恢复至满值
- 显示升级提示消息

### 3. GUI界面

**打开方式**：对着快乐恶魂按住 Shift + 右键

**界面元素**：
1. **外观预览**：简化的快乐恶魂图标（带等级徽章）
2. **等级显示**：当前等级信息
3. **血量条**：红色进度条，显示当前/最大血量
4. **饱食度条**：橙色进度条，显示当前/最大饱食度
5. **经验条**：绿色进度条，显示当前经验/升级所需经验
   - 满级时显示"满级"标识

**界面特点**：
- 深色半透明背景，金色装饰线
- 所有进度条带有数值显示
- 清晰的视觉反馈

### 4. 饱食度系统

**自动降低机制**：
- 每秒自动降低饱食度
- 降低速率取决于当前等级
- 等级越高，降低速度越慢

**数据持久化**：
- 饱食度数据保存在实体NBT中
- 重新加载世界后数据保持不变

## 技术实现

### 核心类说明

1. **LevelConfig.java**
   - 定义6个等级的配置数据
   - 计算食物经验值
   - 提供等级相关的查询方法

2. **HappyGhastData.java**
   - 存储快乐恶魂的等级、经验、饱食度
   - 处理经验值增加和升级逻辑
   - NBT序列化和反序列化

3. **HappyGhastScreen.java**
   - GUI界面渲染
   - 显示外观预览、血量、饱食度、经验、等级
   - 美观的界面设计

4. **HappyGhastEntityMixin.java**
   - 注入快乐恶魂实体
   - 处理Shift+右键交互（打开GUI）
   - 处理喂食逻辑
   - 定期更新饱食度
   - 自动更新血量上限

5. **网络包**
   - OpenGhastGuiPayload：客户端请求打开GUI
   - SyncGhastDataPayload：服务端同步数据到客户端

### 数据访问器接口

使用 `HappyGhastDataAccessor` 接口通过Mixin安全地访问和存储数据，避免直接操作NBT的复杂性。

## 使用指南

### 玩家操作

1. **查看快乐恶魂信息**
   - 对着快乐恶魂按住 Shift + 右键
   - 查看等级、血量、饱食度和经验

2. **喂食快乐恶魂**
   - 手持食物，右键点击快乐恶魂
   - 系统会显示增加的饱食度和经验值
   - 经验值达到要求会自动升级

3. **升级提示**
   - 升级时会显示消息："快乐恶魂升级到了等级 X！"
   - 饱食度自动恢复至新等级的满值

### 原有功能保留

- H键问候快乐恶魂功能保持不变
- 箱子矿车放置功能完全保留

## 代码特点

### 可维护性
- 清晰的类结构和职责划分
- 详细的中文注释
- 使用配置类集中管理等级数据

### 可扩展性
- 易于添加新等级
- 易于添加新的经验获取方式
- 易于扩展GUI显示内容

### 游戏平衡性
- 经验值设计合理，保持游戏进度平衡
- 饱食度系统鼓励玩家定期照顾快乐恶魂
- 等级提升带来显著但不过分的能力提升

## 未来扩展建议

1. **更多经验获取方式**
   - 战斗经验
   - 陪伴时间
   - 完成特定任务

2. **等级特权**
   - 每个等级解锁特殊能力
   - 等级越高速度越快
   - 特殊攻击技能

3. **外观变化**
   - 不同等级有不同的外观效果
   - 粒子效果
   - 体型变化

4. **社交功能**
   - 多个玩家共同培养
   - 排行榜系统
   - 成就系统

## 编译信息

- **Minecraft版本**：1.21.9
- **Fabric Loader**：0.16.14+
- **Java版本**：21
- **编译状态**：✅ 成功

生成的JAR文件：
- chest-on-ghast-1.0.3.jar
- chest-on-ghast-1.0.3-sources.jar

## 总结

本次实现完全满足用户需求：
✅ 六个等级系统
✅ 血量和饱食度随等级变化
✅ 饱食度降低系统（等级越高降低越慢）
✅ 经验值系统
✅ 喂食增加经验
✅ Shift+右键打开GUI
✅ GUI显示外观预览、血量、饱食度、经验、等级
✅ 代码结构清晰，具有可维护性和可扩展性
✅ 数值设计平衡，符合游戏性要求
